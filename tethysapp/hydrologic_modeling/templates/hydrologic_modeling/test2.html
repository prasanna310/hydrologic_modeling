{% extends "hydrologic_modeling/home.html" %}
{% load staticfiles %}
{% load tethys_gizmos %}


{% block app_navigation %}

<!--Model inputs user form-->
<div id='form-container' class='' style="">

    <form id='user-form' method="post" action="{% url 'hydrologic_modeling:test1' %}" enctype="multipart/form-data">
        {% csrf_token %}

        <div id="model domain">
                  {% gizmo text_input simulation_name %}

          <table style="width:100%">
              <tr>
                    <th> {% gizmo text_input cell_size %} </th>
                    <th> {% gizmo text_input timestep %} </th>
              </tr>

          </table>

            <p id='box_title' class="form-subtitle"> Bounding Box (US continent only)</p>
            <table  style="margin-top:20px">

                <tr>
                    <td/>
                    <td >{% gizmo text_input north_lat %}</td>
                    <td/>
                </tr>
                <tr>
                    <td width="200px">{% gizmo text_input west_lon %}</td>
                    <td width="200px"/>
                    <td width="200px">{% gizmo text_input east_lon %}</td>
                </tr>
                    <td/>
                    <td >{% gizmo text_input south_lat %}</td>
                    <td/>
                </tr>
            </table>

            <p id='point_title' class="form-subtitle">Watershed Outlet Point (Optional)</p>
            <table style="margin-top:20px">
                <tr>
                    <td>{% gizmo text_input outlet_x %}</td>
                    <td width="10px"/>
                    <td>{% gizmo text_input outlet_y %}</td>
                </tr>
            </table>


            </div>

           <table >
              <tr>
                    <th> {% gizmo date_picker simulation_start_date_picker %} </th>
                    <th>  {% gizmo date_picker simulation_end_date_picker %} </th>
              </tr>
              <tr>
                    <td>{% gizmo select_input timeseries_source %}</td>
                    <td>{% gizmo select_input model_engine %} </td>
              </tr>
          </table>


          {% gizmo text_input USGS_gage %}
          {% gizmo text_input threshold %}



          Optionally, upload .shp file geometry <br>
          <table >
              <tr>
                  <th> Outlet </th>
                  <th><input type="file" name="outlet_shp" multiple> </th>
                  <!--<th><input type="submit" name="Upload" value="Upload" /> </th>-->
              </tr>

              <tr>
                  <th> Watershed </th>
                  <th><input type="file" name="watershed_shp" multiple> </th>
                  <!--<th><input type="submit" name="Upload" value="Upload" /> </th>-->
              </tr>

           </table>


        <div id="submit-response" >
            <p id="response-status"></p>
            <p id="response-result"></p>
        </div>

        <input id='submit-model-input-btn' type="submit" value="Prepare the Model" name='input-form' >


    </form>



    <div id="wait" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Please wait for form processing..</h4>
                </div>
                <div class="modal-body">
                    <img align="middle" src="{% static 'hydrologic_modeling/images/waiting.gif' %}" width="550px" height="20px"/>
                </div>
            </div>
            <!--End modal content-->
        </div>
    </div>


</div>


{%endblock%}

{% block app_content%}
<!--Google map-->
<div id='map-container' >
    <!-- app intro-->
    <div id='title' style="margin-bottom:5px">
        <h5 style="color:#0073e6">Input Data Preparation</h5>

        <p >
            The model input package includes different forcing dataset and model parameter files,
            which will be automatically created as Model Instance resource in HydroShare.
        </p>

    </div>

    <!-- map -->
    <p style="color:#878787" >Please draw the bounding box (domain) and outlet point to the watershed (US continent only)</p>
    <div id="map" style="width:900px; height:500px"></div>

    <p data-toggle="collapse" data-target="#intro-detail" style="color: green; margin-bottom: 10px"><strong><u>See more details</u></strong></p>

        <div id="intro-detail" class="collapse" style="background-color:#f2f2f2">
            <p style="font-size:100%">
                <strong>Terrain variables:</strong> terrain slope and aspect. Data are derived from National Elevation Datasets USGS.<br>
                <strong>Land cover variables:</strong> canopy coverage fraction, canopy height, leaf area index. Data are derived from National Land Cover Dataset.<br>
                <strong>Climate variables:</strong> incoming shortwave, minimum air temperature, maximum air temperature, air vapor pressure, precipitation. Data are derived from Daymet .<br>
                <strong>Model parameter files:</strong> control.dat, param.dat, siteinitial.dat, inputcontrol.dat, outputcontrol.dat.
            </p>
        </div>

</div>

{%endblock%}



{% block app_actions %}
{% endblock %}

{% block scripts %}
  {{ block.super }}
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHOUQD9R_tLb6NKA22cuTTvF0j6X8wkgI&callback=initMap&libraries=drawing">
    </script>
    <script src="{% static 'hydrologic_modeling/js/model_input.js' %} " type="text/javascript"></script>
{% endblock %}

{% block content_dependent_styles %}
  {{ block.super }}
  <link href="{% static 'hydrologic_modeling/css/model_input.css' %}" rel="stylesheet"/>
{% endblock %}
