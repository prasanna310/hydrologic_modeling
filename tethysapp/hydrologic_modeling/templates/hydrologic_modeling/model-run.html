{% extends "hydrologic_modeling/model-calibration.html" %}
{% load tethys_gizmos %}

{% block app_navigation_items %}
  <form method="post" action="{% url 'hydrologic_modeling:model_run' %}" >
      {% csrf_token %}
      <b> Did not like the result? Change the model parameters   </b>
      <br>
      <br>

      Calibration Parameters
      <table style="width:100%">
          <tr>
                <th> {% gizmo text_input fac_L %} </th>
                <th> {% gizmo text_input fac_Ks %} </th>
          </tr>
          <tr>
                <td>{% gizmo text_input fac_n_o %}</td>
                <td>{% gizmo text_input fac_n_c %}</td>
          </tr>
          <tr>
                <td>{% gizmo text_input fac_th_s %}</td>
                <td></td>
          </tr>
          </table>
      <br>
      Numeric Parameters
          <table style="width:100%">
          <tr>
                <th> {% gizmo text_input pvs_t0 %} </th>
                <th> {% gizmo text_input vo_t0 %} </th>
          </tr>
          <tr>
                <td>{% gizmo text_input qc_t0 %}</td>
                <td>{% gizmo text_input kc %}</td>
          </tr>


        </table>
      {% gizmo select_input simulation_names_list %}

      <input type="submit" name="input-form" class="btn btn-default">
      <input type="hidden" name="model_inputs_table_id_from_another_html" value= {{hs_resource_id_created}}>
  </form>
{% endblock %}



{% block app_content %}
  If the simulation is retreived from the drop down menu, the name of the sim will be:

  <h3> Test Variable: <u><b>{{test_variable}}</b></u>  </h3>
  <h3> Previous simulation id: <u><b>{{simulation_loaded_id}}</b></u>  </h3>
  <h3> Last simulation HS- ID : <u><b>{{current_model_inputs_table_id}}</b></u>  </h3>
  <!--<h3> Test string: <u><b>{{test_string}}</b></u>  </h3>-->
  <h3> The_resource_id_created: <u><b>{{hs_resource_id_created}}</b></u>  </h3>


  <!--If the user wants to download only  -->
  {% if download_status %}
            <h2> Congratulations! Files were created successfully! </h2>
            <hr>
                <p> The created geospatial and forcing files can be accessed temporarily by using this link: </p>
<!--<a href="{{download_link}}"> {{download_link}}</a>-->
                <p> The HydroShare ID for the resource that contains the created files are <strong>{{hs_res_created}}</strong>  </p>
                <p> The dictionary that contains links to all the files created is: <strong>{{download_link}}</strong>  </p>

          {% else %}
                <h2>Please wait.....</h2>
                <hr>
                <p> The request is being processed. Please wait while the input files (geospatial, and forcing files) for the region selected are being created</p>
                <p> Test string : {{test_string}}</p>
  {% endif %}





  <!--if the user creates a simulation.. :TODO need to have 'and' clause for no download case in the if statement below-->
  {% if simulation_name != None %} <!--- If the input is complete --->
        <h5> Congratulations! <u><b>{{simulation_name}}</b></u> ran successfully!  </h5>

      Here is the simulated discharge for the outlet you picked. <b>(long: {{outlet_lon}} , lat: {{outlet_lat}}) </b>
        <br>

      {% gizmo plot_view observed_hydrograph %}
      {% gizmo plot_view observed_hydrograph2 %}

      {% gizmo plot_view line_plot_view %}

   {% endif %}




  <!--if the user modifies a simulation.. -->
  {% if fac_L_form != "" %} <!--- If the input is complete --->
      <h5> Congratulations <b>{{user_name}}</b>! Parameters were changed successfully!  </h5>
            Using the calibratoin parameters provided, the graph was updated for the ll-input id: {{Iwillgiveyou_model_inputs_table_id_from_another_html}}


            {% gizmo plot_view observed_hydrograph_userModified %}
            {% gizmo plot_view observed_hydrograph_userModified2 %}


   {% endif %}

  {% if simulation_loaded_id != "" %} <!--- If the input is complete --->
      <h5> Congratulations <b>{{user_name}}</b>! Parameters were changed successfully!  </h5>
            Using the calibratoin parameters provided, the graph was updated for the ll-input id: {{Iwillgiveyou_model_inputs_table_id_from_another_html}}


            {% gizmo plot_view observed_hydrograph_loaded %}
            {% gizmo plot_view observed_hydrograph_loaded2 %}


   {% endif %}


{% endblock %}



{% block app_actions %}
  <a href="{% url 'hydrologic_modeling:model_input' %}" class="btn btn-default">Back</a>
{% endblock %}